<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="org.miraiboot.mapper.PermissionMapper">
    <resultMap id="BaseMap" type="org.miraiboot.entity.PermissionItem">
        <id column="id" property="id" jdbcType="INTEGER"/>
        <result column="command_id" property="commandId" jdbcType="INTEGER"/>
        <result column="sender_id" property="senderId" jdbcType="VARCHAR"/>
        <result column="permit" property="permits" jdbcType="TINYINT"/>
        <result column="remain" property="remain" jdbcType="INTEGER"/>
    </resultMap>

    <select id="getPermission" resultMap="BaseMap">
        SELECT `id`, `command_id`, `sender_id`, `permit`, `remain`
        FROM `permission`
        WHERE `sender_id` = #{senderId}
        AND `command_id` = #{commandId}
    </select>

    <insert id="updatePermission">
        INSERT INTO `permission`(`command_id`, `sender_id`, `permit` , `remain`)
        VALUES (#{commandId}, #{senderId}, #{permits}, #{remain})
        ON DUPLICATE KEY
        UPDATE `permit` = #{permit}
    </insert>

    <delete id="removePermission">
        DELETE FROM `permission`
        WHERE sender_id = #{senderId}
        AND `command_id` = #{commandId}
    </delete>

</mapper>